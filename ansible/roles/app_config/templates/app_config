DJANGO_SECRET_KEY: {{ django_secret_key }}
DEBUG: {{ django_debug }}
ALLOWED_HOSTS: {{ django_allowed_hosts | to_nice_json }}
ALWAYS_RELOAD_REFERENCE_DATA_ON_RESTART: {{ reload_ref_data_on_app_restart }}
METAX_ENV: {{ deployment_environment_id }}

# Variables related to database
METAX_DATABASE: {{ metax_database.name }}
METAX_DATABASE_USER: {{ metax_database.user }}
METAX_DATABASE_PASSWORD: {{ metax_database.password }}
METAX_DATABASE_HOST: {{ dbserver_1_internal_ip | default('127.0.0.1') }}

# Variables related to elasticsearch
ELASTICSEARCH:
  HOSTS: {{ elasticsearch.hosts | to_nice_json }}
  PORT: {{ elasticsearch.port }}
  USE_SSL: {{ elasticsearch.use_ssl }}

# Variables related to redis
REDIS:
  PASSWORD: '{{ redis_common.password }}'

  TEST_DB: 15
  # when all instances run on localhost, any instance is fine. when
  # running in other envs, assumption is all instances use identical ports.
  LOCALHOST_PORT: {{ redis_common.localhost_port }}

  SENTINEL:
    HOSTS: {{redis_common.sentinel.hosts | to_nice_json }}
    SERVICE: '{{ redis_common.sentinel.service_name }}'

# Variables related to rabbitmq
RABBITMQ:
  HOSTS: {{ rabbitmq_common.hosts | to_nice_json }}
  PORT: {{ rabbitmq_common.port }}

  USER: {{ rabbitmq_common.user }}
  PASSWORD: {{ rabbitmq_common.password }}
  VHOST: {{ rabbitmq_common.vhost }}

  CONSUMERS: {{ rabbitmq_consumers | to_nice_json }}

# allowed api auth methods in HTTP Authorization header. to disable End User access
# altogether, remove "Bearer" from below list.
ALLOWED_AUTH_METHODS: {{ allowed_auth_methods | to_nice_json }}

# Variables related to api credentials
API_USERS: {{ nginx_credentials | to_nice_json }}

ATT_DATACATALOG_IDENTIFIER: {{ att_datacatalog_identifier }}
IDA_DATACATALOG_IDENTIFIER: {{ ida_datacatalog_identifier }}
LEGACY_DATACATALOG_IDENTIFIER: {{ legacy_datacatalog_identifier }}

# specify read and write access of services per api, or if an api is readable by world
API_ACCESS: {
    "rest": {
        "apierrors": {
            "read":  ["metax"],
            "write": ["metax"]
        },
        "contracts": {
            "read":  ["metax", "tpas"],
            "write": ["metax", "tpas"]
        },
        "datacatalogs": {
            "read":  ["metax", "all"],
            "write": ["metax", "etsin"]
        },
        "datasets": {
            "read":  ["all"],
            "write": ["metax", "qvain", "etsin", "tpas", "endusers"]
        },
        "directories": {
            "read":  ["metax", "qvain", "etsin", "tpas", "fds", "endusers"],
            "write": []
        },
        "files": {
            "read":  ["metax", "ida", "fds", "tpas", "endusers"],
            "write": ["metax", "ida", "tpas"]
        },
        "filestorages": {
            "read":  ["metax"],
            "write": ["metax"]
        },
        "schemas": {
            "read":  ["all"],
            "write": []
        }
    },
    "rpc": {
        "datasets": {
            "get_minimal_dataset_template": { "use": ["all"] }
        },
        "statistics": {
            "all_datasets_cumulative":          { "use": ["all"] },
            "catalog_datasets_cumulative":      { "use": ["all"] },
            "count_datasets":                   { "use": ["all"] },
            "deprecated_datasets_cumulative":   { "use": ["all"] },
            "end_user_datasets_cumulative":     { "use": ["all"] },
            "harvested_datasets_cumulative":    { "use": ["all"] },
            "organization_datasets_cumulative": { "use": ["all"] },
            "unused_files":                     { "use": ["all"] }
        }
    }
}

# Variables for the OAI-PMH API
OAI:
  BASE_URL: {{ oai.base_url }}
  BATCH_SIZE: {{ oai.batch_size }}
  REPOSITORY_NAME: {{ oai.repository_name }}
  ETSIN_URL_TEMPLATE: {{ oai.etsin_url_template }}
  ADMIN_EMAIL: {{ oai.admin_email }}
  SET_MAPPINGS:
    datasets:
      - "{{att_datacatalog_identifier}}"
      - "{{ida_datacatalog_identifier}}"
    att_datasets:
      - "{{att_datacatalog_identifier}}"
    ida_datasets:
      - "{{ida_datacatalog_identifier}}"

DATACITE:
    USERNAME: {{ datacite.username }}
    PASSWORD: {{ datacite.password }}
    ETSIN_URL_TEMPLATE: {{ datacite.etsin_url_template }}
    PREFIX: {{ datacite.prefix }}
